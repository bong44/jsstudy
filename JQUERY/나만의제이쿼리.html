<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
<div id="id_disp1"></div>
<div id="id_disp2"></div>
<div class="cl_disp"></div>
<div class="cl_disp"></div>
<div class="cl_disp"></div>
<div></div>
<div></div>
<script>

    //-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    //3. 메모리의 효율을 위해 한번만 실행 될 수 있게끔 '즉각실행함수'로 만듬 (여기서 발생하는 문제: 내부에 있는 값들을 밖에서 접근할 수 없게 됨) = 전역변수 필요! --> 4번에서 계속
    (function (/*here*/) { 
        //-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
        //2. 1단계에서의 생성자함수(클래스)를 자동으로 새로운 인스턴스(new)로서 자동 생성해주는 중계 함수를 만들어줌 (여기서 factory가 굳이 필요한 이유는, 나중에 prototype의 속성의 함수를 밖에서 만들 수 있게 끔 해주는 좌표역할을 위함)
        var myFactory = function (p_selector) { //중계 함수이기 때문에 목적지가 원하는 selector 파라미터를 요구
            //2-2. 받고자 하는 곳에 1단계 근본 함수의 실행값을 인스턴스 형태로 넘겨줌
            return new MyClass(p_selector);
        }
        //-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
        
        //-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
        //1. 단계 태그를 추출하는 근본 함수생성(생성자 함수임 !중요!) == 클래스 (사용자 정의 데이터)
        var MyClass = function (p_selector) {
            //1-2. html 태그정보를 받아온 배열(querySelectorAll 메소드는 html정보를 뽑아오기에 document의 메소드)
            var v_elems = document.querySelectorAll(p_selector);  // console.log(v_elems);  == [div#id_disp1, div#id_disp2, div.cl_disp, div.cl_disp, div.cl_disp, div, div]의 배열 형태로 넘어옴
            //1-3. 생성자함수(클래스)에 length 속성 추가와 동시에 v_elems 배열의 길이 셋팅
            this.length = v_elems.length;
            for (var i = 0; i < v_elems.length; i++) {
                //1-4. 생성자함수(클래스)에 'i'라는 속성에 배열의 i번째들을 추가 //여기서 알 수 있는 점, 중간지점에서 받는 ($)은 JSON형태라는 것을 알 수 있음
                this[i] = v_elems[i];
            }
        }
        //-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
        //4. 즉각실행함수의 제약사항 극복을 위한 전역변수 생성과 동시, 중계함수(factory함수)를 '$'라는 별명의 전역 함수로 생성!! 중요!!
        window.$ = myFactory; //여기서 중요! window는 JSON형태, 우리가 var 하고 선언하는 변수는 window.변수 라고 선언하는 것과 같음, 즉 브라우저에 전역변수로 선언한 것과 같음!
        //4-2. 근본 생성자함수(클래스)의 내부에 함수를 직접 추가하지 않고, 외부에서 공용 메소드를 추가할 수 있도록 중계함수에 fn 속성을 prototype을 담아서 추가.
        myFactory.fn = MyClass.prototype;
    })(/*here*/); // <--여기 소괄호 안에는 파라미터를 넘길 수 있음. 넘기면, 위에 here이란 곳에 파라미터로 들어감
    //-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------


</script>
</body>
</html>